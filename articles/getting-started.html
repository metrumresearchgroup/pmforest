<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started with pmforest • pmforest</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with pmforest">
<meta property="og:description" content="pmforest">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmforest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started with pmforest</a>
    </li>
    <li>
      <a href="../articles/multiple-simulations.html">Multiple Simulations</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/metrumresearchgroup/pmforest" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started with pmforest</h1>
                        <h4 data-toc-skip class="author">Kyle Barrett</h4>
            
      
      
      <div class="hidden name"><code>getting-started.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pmforest</span><span class="op">)</span></code></pre></div>
<style> body {text-align: justify} </style>
<div class="section level2">
<h2 id="introductionscope">Introduction/Scope<a class="anchor" aria-label="anchor" href="#introductionscope"></a>
</h2>
<p><code>pmforest</code> is a package for producing forest plots: graphical summaries of covariate effects or covariate-dependent predictions in a pharmacometric model.</p>
<p>Given a dataset of model responses or model parameters with uncertainty at various covariate levels, the package generates plots of confidence intervals reflecting the predicted impact of the covariates. This uncertainty could come from a variety of sources, for example: simulations, bootstrapping, Bayesian posteriors.</p>
<hr>
<p><br></p>
</div>
<div class="section level2">
<h2 id="input-data">Input data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>To use the forest plot function you will have raw data coming from something like simulations. Before plotting, the raw data must first be summarized. To help with this, <code>pmforest</code> has a <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html"><code>summarize_data()</code></a> function. The usage of this function is described in the next section, but note that <strong>the user can write their own custom summarization function</strong>, as long as the data it returns conforms to the format described in the “Output Data” section of <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html#details"><code>?summarize_data</code></a>.</p>
<div class="section level3">
<h3 id="raw-data">Raw data<a class="anchor" aria-label="anchor" href="#raw-data"></a>
</h3>
<p>The raw dataset must be in long format and have the following:</p>
<ul>
<li>A numeric column containing the values to be summarized (passed to <code>value</code> argument of <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html"><code>summarize_data()</code></a>).</li>
<li>A character (or factor) column containing the groups to summarize over (passed to <code>group</code> argument of <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html"><code>summarize_data()</code></a>).</li>
</ul>
<p>It can optionally have other grouping columns, described in the <code>group_level</code>, <code>metagroup</code>, and <code>replicate</code> arguments of <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html#arguments"><code>?summarize_data</code></a>. Note that specifying a <code>replicate</code> column (i.e. a simulation number) will result in a plot with multiple intervals per group level (see <a href="https://metrumresearchgroup.github.io/pmforest/articles/multiple-simulations.html">the “Multiple Simulations” vignette</a>).</p>
<p>An example dataset that meets these specifications comes with the package:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rawData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"test-data"</span>, <span class="st">"plotData.RDS"</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"pmforest"</span><span class="op">)</span><span class="op">)</span>
<span class="va">rawData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">stat</span>, <span class="va">GROUP</span>, <span class="va">LVL</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="co">#&gt;    stat GROUP LVL     </span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  1.04 AGE   20 years</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  1.06 AGE   20 years</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span>  1.04 AGE   20 years</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span>  1.03 AGE   20 years</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span>  1.04 AGE   20 years</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span>  1.01 AGE   20 years</span></code></pre></div>
<p>In this example, <code>stat</code> is the “value”, <code>GROUP</code> is the “group” column, and <code>LVL</code> will be “group_level”.</p>
</div>
<div class="section level3">
<h3 id="summarize-data">Summarize data<a class="anchor" aria-label="anchor" href="#summarize-data"></a>
</h3>
<p>Now we pass this data to <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html"><code>summarize_data()</code></a>. This is where the confidence interval and other relevant statistical parameters will be calculated.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sumData</span> <span class="op">&lt;-</span> <span class="va">rawData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_data.html">summarize_data</a></span><span class="op">(</span>
    value <span class="op">=</span> <span class="va">stat</span>,
    group <span class="op">=</span> <span class="va">GROUP</span>,
    group_level <span class="op">=</span> <span class="va">LVL</span>,
    probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.95</span><span class="op">)</span>,
    statistic <span class="op">=</span> <span class="st">"median"</span>
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sumData</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="co">#&gt;   group group_level   mid    lo    hi</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AGE   20 years    1.02  0.966 1.09 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AGE   45 years    0.991 0.963 1.02 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> ALB   3.25 g/dL   0.870 0.839 0.898</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> ALB   5 g/dL      1.05  1.04  1.06 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> EGFR  Mild        0.915 0.904 0.925</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> EGFR  Moderate    0.699 0.664 0.731</span></code></pre></div>
<p>The output data will have three new columns <code>mid</code>, <code>lo</code>, and <code>hi</code>, containing the summarized values (from the data in <code>value</code>) corresponding to what was passed to <code>statistic</code> (<code>mid</code>) and <code>probs</code> (<code>lo</code>/<code>hi</code>). The <code>group</code> and <code>group_level</code> columns will also be renamed as seen above.</p>
<p>Note that, if a <code>replicate</code> column is passed, there will be nine numeric columns (instead of three) output from <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html"><code>summarize_data()</code></a>. See <a href="https://metrumresearchgroup.github.io/pmforest/articles/multiple-simulations.html">the “Multiple Simulations” vignette</a> for an example of this.</p>
<div class="section level4">
<h4 id="column-names">Column names<a class="anchor" aria-label="anchor" href="#column-names"></a>
</h4>
<p>It’s worth noting here that <a href="https://metrumresearchgroup.github.io/pmforest/reference/plot_forest.html"><code>plot_forest()</code></a> (discussed in the next section) will assume the column names shown above, and will throw an error if they are renamed to anything else. In cases where users would like to reformat these tables for reports, it is recommended to do so <em>after</em> plotting the data.</p>
<hr>
<p><br></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="plot-generation">Plot generation<a class="anchor" aria-label="anchor" href="#plot-generation"></a>
</h2>
<p>The main plotting function is <a href="https://metrumresearchgroup.github.io/pmforest/reference/plot_forest.html"><code>pmforest::plot_forest()</code></a>. In the examples below we will use the dataset shown above. Here is a basic example:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sumData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span><span class="op">)</span> </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<p><br></p>
<div class="section level3">
<h3 id="formatting-arguments">Formatting Arguments<a class="anchor" aria-label="anchor" href="#formatting-arguments"></a>
</h3>
<p>Below are a few examples showcasing the uses of some of the function arguments, as well as additional formatting techniques using the <a href="https://github.com/thomasp85/patchwork" class="external-link">patchwork</a> R package.</p>
<p><br></p>
<div class="section level4">
<h4 id="basics">Basics<a class="anchor" aria-label="anchor" href="#basics"></a>
</h4>
<p>You can add a vertical line (at some reference value), and suppress adding the table of confidence intervals.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sumData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>vline_intercept <span class="op">=</span> <span class="fl">1</span>, 
              annotate_CI <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="adding-group-labels">Adding group labels<a class="anchor" aria-label="anchor" href="#adding-group-labels"></a>
</h4>
<p>The <code>summary_labels</code> argument takes a <a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="external-link"><code>ggplot2::labeller()</code></a> function. In this example, we load a list of covariate labels with the <a href="https://github.com/metrumresearchgroup/yspec" class="external-link"><code>yspec</code> package</a> and pass it through <a href="https://ggplot2.tidyverse.org/reference/as_labeller.html" class="external-link"><code>ggplot2::as_labeller()</code></a>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">spec_file</span> <span class="op">&lt;-</span> <span class="fu">yspec</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yspec/man/ys_load.html" class="external-link">ys_load</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"test-data"</span>, <span class="st">"spec"</span>, <span class="st">"analysis3.yml"</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"pmforest"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">all_labels</span> <span class="op">&lt;-</span> <span class="fu">yspec</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yspec/man/ys_get_short.html" class="external-link">ys_get_short</a></span><span class="op">(</span><span class="va">spec_file</span>, title_case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">plot_labels</span> <span class="op">&lt;-</span> <span class="fu">as_labeller</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">all_labels</span><span class="op">)</span><span class="op">)</span>

<span class="va">sumData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>vline_intercept <span class="op">=</span> <span class="fl">1</span>, 
              summary_label <span class="op">=</span> <span class="va">plot_labels</span><span class="op">)</span> </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-6-1.png" width="672"> Notice the more informative group labels on the y-axis and the CI table, as compared to the raw values from <code>GROUP</code> shown in the previous plots.</p>
</div>
<div class="section level4">
<h4 id="adding-captions-and-other-labels">Adding captions and other labels<a class="anchor" aria-label="anchor" href="#adding-captions-and-other-labels"></a>
</h4>
<p>This example illustrates the use of the other labelling arguments (<code>CI_label</code>, <code>x_lab</code>, and <code>caption</code>).</p>
<p>Some notes:</p>
<ul>
<li>The title at the top of the plot (“CL (L/hr)” in the example below) is pulled from the <code>metagroup</code> column of the data, as it is most useful when using <code>metagroup</code> to make multiple plots (shown later on). Here we just create it with <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> (and add a label for it to <code>plot_labels</code>).</li>
<li>
<code>caption</code> is a <code>patchwork</code> argument. You can change the <code>caption</code> formatting using <code>patchwork</code> functions (see “Patchwork Annotations” section below).</li>
<li>If <code>CI_label</code> is <em>not</em> passed, the value passed to <code>x_lab</code> will be used for the table label.</li>
<li>
<code>text_size</code> applies directly to <code>ggplot</code> layers (minimum is 3.5), though the table text will scale with this input accordingly.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_labels</span><span class="op">$</span><span class="va">CL</span> <span class="op">&lt;-</span> <span class="st">'CL (L/hr)'</span>
<span class="va">plot_labels</span> <span class="op">&lt;-</span> <span class="fu">as_labeller</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">all_labels</span><span class="op">)</span><span class="op">)</span>

<span class="va">sumData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>metagroup <span class="op">=</span> <span class="st">"CL"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>vline_intercept <span class="op">=</span> <span class="fl">1</span>, 
              x_lab <span class="op">=</span> <span class="st">"Fraction and 95% CI\nRelative to Reference"</span>,
              CI_label <span class="op">=</span> <span class="st">"Median [95% CI]"</span>,
              summary_label <span class="op">=</span> <span class="va">plot_labels</span>,
              text_size <span class="op">=</span> <span class="fl">3.5</span>,
              caption <span class="op">=</span> <span class="st">"This is a patchwork caption.
                         You can add multiple lines."</span><span class="op">)</span> </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="shaded-interval">Shaded Interval<a class="anchor" aria-label="anchor" href="#shaded-interval"></a>
</h4>
<p>You can add a shaded interval over a specified range. It is important to note that the x-axis is automatically determined based on your input data. The specified interval may therefore be cut off, as the x limits do not adjust based on the specified interval. You can correct for this by specifying the <code>x_breaks</code> and <code>x_limit</code> arguments.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sumData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>metagroup <span class="op">=</span> <span class="st">"CL"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>vline_intercept <span class="op">=</span> <span class="fl">1</span>, 
              x_lab <span class="op">=</span> <span class="st">"Fraction and 95% CI\nRelative to Reference"</span>,
              CI_label <span class="op">=</span> <span class="st">"Median [95% CI]"</span>,
              summary_label <span class="op">=</span> <span class="va">plot_labels</span>,
              caption <span class="op">=</span> <span class="st">"This is a patchwork caption.
                         You can add multiple lines."</span>,
              shaded_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">1.25</span><span class="op">)</span>,
              x_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span>, <span class="fl">1.6</span><span class="op">)</span>, 
              x_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">1.45</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="multiple-covariates-or-facets">Multiple covariates (or facets)<a class="anchor" aria-label="anchor" href="#multiple-covariates-or-facets"></a>
</h4>
<p>Here we pull in a new dataset with the <code>param</code> column containing both <code>V2</code> and <code>CL</code>, where the previous example only contained <code>CL</code>, and pass this to the <code>metagroup</code> argument of <a href="https://metrumresearchgroup.github.io/pmforest/reference/summarize_data.html"><code>summarize_data()</code></a>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sumData2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"test-data"</span>, <span class="st">"plotData2.RDS"</span><span class="op">)</span>, package <span class="op">=</span> <span class="st">"pmforest"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/summarize_data.html">summarize_data</a></span><span class="op">(</span>
    value <span class="op">=</span> <span class="va">stat</span>,
    group <span class="op">=</span> <span class="va">GROUP</span>,
    group_level <span class="op">=</span> <span class="va">LVL</span>,
    metagroup <span class="op">=</span> <span class="va">param</span>
  <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sumData2</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span>
<span class="co">#&gt;   group group_level metagroup   mid    lo    hi</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AGE   20 years    CL        1.02  0.966 1.09 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> AGE   20 years    V2        1     1     1    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> AGE   45 years    CL        0.991 0.963 1.02 </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> AGE   45 years    V2        1     1     1    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> ALB   3.25 g/dL   CL        0.870 0.839 0.898</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> ALB   3.25 g/dL   V2        1     1     1</span></code></pre></div>
<p>The <code>metagroup</code> argument doesn’t necessarily have to facet across multiple covariates, though this is a common use case. When doing this, you may consider setting <code>annotate_CI = FALSE</code> to simplify the plots.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_labels</span><span class="op">$</span><span class="va">CL</span> <span class="op">&lt;-</span> <span class="st">'CL (L/hr)'</span>
<span class="va">all_labels</span><span class="op">$</span><span class="va">V2</span> <span class="op">&lt;-</span> <span class="st">'V (L)'</span>
<span class="va">plot_labels</span> <span class="op">&lt;-</span> <span class="fu">as_labeller</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">all_labels</span><span class="op">)</span><span class="op">)</span>

<span class="va">sumData2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>vline_intercept <span class="op">=</span> <span class="fl">1</span>, 
              x_lab <span class="op">=</span> <span class="st">"Fraction and 95% CI\nRelative to Reference"</span>,
              CI_label <span class="op">=</span> <span class="st">"Median [95% CI]"</span>,
              summary_label <span class="op">=</span> <span class="va">plot_labels</span>,
              caption <span class="op">=</span> <span class="st">"This is a patchwork caption.
                         You can add multiple lines."</span>,
              annotate_CI <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<p>Regardless, you can specify how you want to align the plots using the <code>nrow</code> argument or other functions in the <code>patchwork</code> R package.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sumData2</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>vline_intercept <span class="op">=</span> <span class="fl">1</span>, 
              x_lab <span class="op">=</span> <span class="st">"Fraction and 95% CI\nRelative to Reference"</span>,
              CI_label <span class="op">=</span> <span class="st">"Median [95% CI]"</span>,
              summary_label <span class="op">=</span> <span class="va">plot_labels</span>,
              caption <span class="op">=</span> <span class="st">"This is a patchwork caption.
                         You can add multiple lines."</span>,
              plot_width <span class="op">=</span> <span class="fl">9</span>,
              nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="patchwork-annotations">Patchwork Annotations<a class="anchor" aria-label="anchor" href="#patchwork-annotations"></a>
</h4>
<p>The individual layers of the returned object are defined using <code>ggplot</code>, but the final plot is assembled using <code>patchwork</code>.</p>
<p>Thus you can add additional <code>patchwork</code> themes/annotations to the returned object, but cannot alter the ggplot layers. Themes can be added using the <code>&amp;</code> operator, and follow the same convention as <code>ggplot</code> themes. In this example we change the formatting of the <code>caption</code> argument, combine the plot with an example table, and add some additional labels/titles.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clp</span> <span class="op">&lt;-</span> <span class="va">sumData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>metagroup <span class="op">=</span> <span class="st">"CL"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>vline_intercept <span class="op">=</span> <span class="fl">1</span>, 
              x_lab <span class="op">=</span> <span class="st">"Fraction and 95% CI\nRelative to Reference"</span>,
              CI_label <span class="op">=</span> <span class="st">"Median [95% CI]"</span>,
              summary_label <span class="op">=</span> <span class="va">plot_labels</span>,
              caption <span class="op">=</span> <span class="st">"This is a patchwork caption.
                         You can add multiple lines."</span><span class="op">)</span> 

<span class="fu"><a href="https://patchwork.data-imaginist.com/reference/wrap_plots.html" class="external-link">wrap_plots</a></span><span class="op">(</span><span class="va">clp</span>, <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.text.html" class="external-link">textGrob</a></span><span class="op">(</span><span class="st">'Text on right side'</span><span class="op">)</span>, widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">'Here is a title'</span>,
    subtitle <span class="op">=</span> <span class="st">'Here is a subtitle'</span>,
    caption <span class="op">=</span> <span class="st">'Overrides plot_forest caption argument'</span>,
    tag_levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'A'</span>, <span class="st">'1'</span><span class="op">)</span>, tag_prefix <span class="op">=</span> <span class="st">'Fig. '</span>, tag_sep <span class="op">=</span> <span class="st">'.'</span>, tag_suffix <span class="op">=</span> <span class="st">':'</span>,
    theme <span class="op">=</span> <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="op">&amp;</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,
        plot.tag.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,
        plot.tag <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, hjust <span class="op">=</span> <span class="fl">0</span>, vjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p><br></p>
</div>
<div class="section level4">
<h4 id="full-forest-plot-example">Full Forest Plot Example:<a class="anchor" aria-label="anchor" href="#full-forest-plot-example"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">clp</span> <span class="op">&lt;-</span> <span class="va">sumData</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
          <span class="fu"><a href="../reference/plot_forest.html">plot_forest</a></span><span class="op">(</span>shaded_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">1.25</span><span class="op">)</span>,
                      summary_label <span class="op">=</span> <span class="va">plot_labels</span>,
                      text_size <span class="op">=</span> <span class="fl">4</span>,
                      vline_intercept <span class="op">=</span> <span class="fl">1</span>,
                      x_lab <span class="op">=</span> <span class="st">"Fraction and 95% CI \nRelative to Reference"</span>,
                      CI_label <span class="op">=</span> <span class="st">"Median [95% CI]"</span>,
                      caption <span class="op">=</span> <span class="st">"The shaded area corresponds 
                                 to the interval (0.8, 1.25)"</span>,
                      plot_width <span class="op">=</span> <span class="fl">9</span>, <span class="co"># out of 12</span>
                      x_breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">1</span>, <span class="fl">1.2</span>, <span class="fl">1.4</span><span class="op">)</span>, 
                      x_limit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">1.45</span><span class="op">)</span>,
                      annotate_CI <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
                   
<span class="va">clp</span> <span class="op">+</span>
    <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>
          title <span class="op">=</span> <span class="st">'Figure 1.A'</span>,
          subtitle <span class="op">=</span> <span class="st">'CL (L/hr)'</span>,
          theme <span class="op">=</span> <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> 
    <span class="fu">theme</span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-13-1.png" width="768"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kyle Barrett, Seth Green, Anna-Christina Nevison.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
